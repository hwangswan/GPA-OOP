language: cpp
compiler: gcc

jobs:
  include:
    # Using different os to test.
    - os: linux
      dist: bionic
    - os: windows

    # Create compile file, set permissions and run
    - stage: "Build"
      name: "Build to executable"
      script:
        - sudo cp compile.sh.example compile.sh
        - sudo chmod 0700 compile.sh
        - sudo ./compile.sh

    # Copy executable and test.
    - stage: "Test"
      name: "Test running commands"
      script:
        - sudo cp compile.sh.example compile.sh
        - sudo chmod 0700 compile.sh
        - sudo ./compile.sh
        - sudo cp main tests/main
        - sudo cp data tests/data -r -f
        - cd tests
        - sudo chmod 0700 test.sh
        - sudo ./test.sh
